<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lemcoden.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="who,what,why  hiveçš„ä½œç”¨ æŒ‰ç…§åšç¬”è®°çš„ä¹ æƒ¯æ¥è¯´,è¯´ä¸€ä¸ªæ–°çš„å¤§æ•°æ®å¹³å°æ¡†æ¶,ä¸€èˆ¬å…ˆä»æ¨¡å‹è¯´èµ·,è€Œhiveæœ¬èº«æ˜¯ä¼ä¸šçº§æ•°æ®ä»“åº“å·¥å…·,åŸºäºmapreduceè®¡ç®—å¼•æ“çš„å°è£…(2.xä¹‹åé€æ¸å°†å®˜æ–¹è®¡ç®—å¼•æ“æŒ‡å®šä¸ºspark)æ‰€ä»¥,å°±å…¶æœ¬èº«è€Œè¨€å¹¶æ²¡æœ‰æ¨¡å‹å¯ä»¥è®¨è®º. ä½†æ˜¯æˆ‘ä»¬å¯ä»¥èŠèŠä»–çš„ä½œç”¨,ä»–æ˜¯è§£å†³ä»€ä¹ˆéœ€æ±‚çš„:">
<meta property="og:type" content="article">
<meta property="og:title" content="hive-ç¬”è®°æ€»ç»“">
<meta property="og:url" content="https://lemcoden.github.io/2020/08/27/hive-%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Lemcoden">
<meta property="og:description" content="who,what,why  hiveçš„ä½œç”¨ æŒ‰ç…§åšç¬”è®°çš„ä¹ æƒ¯æ¥è¯´,è¯´ä¸€ä¸ªæ–°çš„å¤§æ•°æ®å¹³å°æ¡†æ¶,ä¸€èˆ¬å…ˆä»æ¨¡å‹è¯´èµ·,è€Œhiveæœ¬èº«æ˜¯ä¼ä¸šçº§æ•°æ®ä»“åº“å·¥å…·,åŸºäºmapreduceè®¡ç®—å¼•æ“çš„å°è£…(2.xä¹‹åé€æ¸å°†å®˜æ–¹è®¡ç®—å¼•æ“æŒ‡å®šä¸ºspark)æ‰€ä»¥,å°±å…¶æœ¬èº«è€Œè¨€å¹¶æ²¡æœ‰æ¨¡å‹å¯ä»¥è®¨è®º. ä½†æ˜¯æˆ‘ä»¬å¯ä»¥èŠèŠä»–çš„ä½œç”¨,ä»–æ˜¯è§£å†³ä»€ä¹ˆéœ€æ±‚çš„:">
<meta property="og:locale">
<meta property="article:published_time" content="2020-08-27T12:50:49.000Z">
<meta property="article:modified_time" content="2023-02-20T15:20:36.113Z">
<meta property="article:author" content="Lemcoden">
<meta property="article:tag" content="åˆ†å¸ƒå¼">
<meta property="article:tag" content="æ•°æ®ä»“åº“">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://lemcoden.github.io/2020/08/27/hive-%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-Hans","comments":true,"permalink":"https://lemcoden.github.io/2020/08/27/hive-%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/","path":"2020/08/27/hive-ç¬”è®°æ€»ç»“/","title":"hive-ç¬”è®°æ€»ç»“"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>hive-ç¬”è®°æ€»ç»“ | Lemcoden</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Lemcoden</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">æ¥è‡ªäºå¤§æ•°æ®æ”»åŸç‹®çš„åˆ†äº«</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#whowhatwhy"><span class="nav-number">1.</span> <span class="nav-text"> who,what,why</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hive%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">1.1.</span> <span class="nav-text"> hiveçš„ä½œç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E7%AE%80%E7%95%A5%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.2.</span> <span class="nav-text"> æ•°æ®ä»“åº“ç®€ç•¥ä»‹ç»</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hive%E7%9A%84%E6%9E%B6%E6%9E%84"><span class="nav-number">2.</span> <span class="nav-text"> hiveçš„æ¶æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hive%E8%BF%9C%E7%A8%8B%E6%95%B0%E6%8D%AE%E5%BA%93metastore%E4%BB%A5%E5%8F%8Ahiveserer2%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text"> hiveè¿œç¨‹æ•°æ®åº“,metastoreä»¥åŠhiveserer2çš„é…ç½®æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hive%E8%BF%9C%E7%A8%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text"> hiveè¿œç¨‹æ•°æ®åº“æ¨¡å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive-metastore%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.2.</span> <span class="nav-text"> hive metastoreæœåŠ¡æ¨¡å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hiveserver2-%E9%85%8D%E7%BD%AE"><span class="nav-number">3.3.</span> <span class="nav-text"> hiveServer2 é…ç½®</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hive%E7%9A%84sql%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">4.</span> <span class="nav-text"> hiveçš„SQL,å‡½æ•°,å‚æ•°</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sql%E8%AF%AD%E5%8F%A5%E4%B9%8Bddl%E8%AF%AD%E5%8F%A5"><span class="nav-number">4.1.</span> <span class="nav-text"> SQLè¯­å¥ä¹‹DDLè¯­å¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive-sql%E8%AF%AD%E5%8F%A5%E4%B9%8Bdml%E8%AF%AD%E5%8F%A5"><span class="nav-number">4.2.</span> <span class="nav-text"> hive SQLè¯­å¥ä¹‹DMLè¯­å¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive-serde"><span class="nav-number">4.3.</span> <span class="nav-text"> hive serde</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive-%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA%E4%B8%8E%E5%88%86%E6%A1%B6"><span class="nav-number">4.4.</span> <span class="nav-text"> hive åŠ¨æ€åˆ†åŒºä¸åˆ†æ¡¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-number">4.5.</span> <span class="nav-text"> hiveçš„å‡½æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive%E7%9A%84%E8%BF%90%E8%A1%8C%E6%96%B9%E5%BC%8F"><span class="nav-number">4.6.</span> <span class="nav-text"> hiveçš„è¿è¡Œæ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hive%E8%A7%86%E5%9B%BE"><span class="nav-number">4.7.</span> <span class="nav-text"> hiveè§†å›¾</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Lemcoden</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://lemcoden.github.io/2020/08/27/hive-%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Lemcoden">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lemcoden">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="hive-ç¬”è®°æ€»ç»“ | Lemcoden">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          hive-ç¬”è®°æ€»ç»“
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-08-27 20:50:49" itemprop="dateCreated datePublished" datetime="2020-08-27T20:50:49+08:00">2020-08-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-20 23:20:36" itemprop="dateModified" datetime="2023-02-20T23:20:36+08:00">2023-02-20</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="whowhatwhy"><a class="markdownIt-Anchor" href="#whowhatwhy"></a> who,what,why</h3>
<h4 id="hiveçš„ä½œç”¨"><a class="markdownIt-Anchor" href="#hiveçš„ä½œç”¨"></a> hiveçš„ä½œç”¨</h4>
<p>æŒ‰ç…§åšç¬”è®°çš„ä¹ æƒ¯æ¥è¯´,è¯´ä¸€ä¸ªæ–°çš„å¤§æ•°æ®å¹³å°æ¡†æ¶,ä¸€èˆ¬å…ˆä»æ¨¡å‹è¯´èµ·,è€Œhiveæœ¬èº«æ˜¯ä¼ä¸šçº§æ•°æ®ä»“åº“å·¥å…·,åŸºäºmapreduceè®¡ç®—å¼•æ“çš„å°è£…(2.xä¹‹åé€æ¸å°†å®˜æ–¹è®¡ç®—å¼•æ“æŒ‡å®šä¸ºspark)æ‰€ä»¥,å°±å…¶æœ¬èº«è€Œè¨€å¹¶æ²¡æœ‰æ¨¡å‹å¯ä»¥è®¨è®º.<br />
ä½†æ˜¯æˆ‘ä»¬å¯ä»¥èŠèŠä»–çš„ä½œç”¨,ä»–æ˜¯è§£å†³ä»€ä¹ˆéœ€æ±‚çš„:</p>
<span id="more"></span>
<ol>
<li>å¯¹æ–‡ä»¶ä»¥åŠæ•°æ®çš„å…ƒæ•°æ®è¿›è¡Œç®¡ç†,æä¾›ç»Ÿä¸€çš„å…ƒæ•°æ®ç®¡ç†æ–¹å¼</li>
<li>ç«¥å·¥æ›´åŠ ç®€å•çš„æ–¹å¼è®¿é—®å¤§è§„æ¨¡çš„æ•°æ®é›†,ä½¿ç”¨SQLè¯­è¨€è¿›è¡Œæ•°æ®åˆ†æ</li>
</ol>
<h4 id="æ•°æ®ä»“åº“ç®€ç•¥ä»‹ç»"><a class="markdownIt-Anchor" href="#æ•°æ®ä»“åº“ç®€ç•¥ä»‹ç»"></a> æ•°æ®ä»“åº“ç®€ç•¥ä»‹ç»</h4>
<p>è¯´åˆ°hiveå°±ä¸å¾—ä¸ææ•°æ®ä»“åº“(Data Warehouse)å¯ç®€å†™ä¸ºDWæˆ–è€…DWH,æ˜¯ä¸ºä¼ä¸šæ‰€æœ‰çº§åˆ«çš„å†³ç­–åˆ¶å®šè¿‡ç¨‹,æä¾›æ‰€æœ‰ç±»å‹æ•°æ®æ”¯æŒçš„æˆ˜ç•¥é›†åˆ.å®ƒæ˜¯å•ä¸ªæ•°æ®å­˜å‚¨,å¤„äºåˆ†ææ€§æŠ¥å‘Šå’Œå†³ç­–æ”¯æŒç›®çš„è€Œåˆ›å»º.ä¸ºéœ€è¦ä¸šåŠ¡æ™ºèƒ½çš„ä¼ä¸š,åœå·¥çŸ¥é“ä¸šåŠ¡æµç¨‹æ”¹è¿›,ç›‘è§†æ—¶é—´,æˆæœ¬,è´¨é‡ä»¥åŠæ§åˆ¶.<br/><br />
ä¸€èˆ¬æ•°æ®ä»“åº“æ˜¯å°†ä¼ä¸šä¸šåŠ¡æ•°æ®åº“,è®¿é—®äº§ç”Ÿçš„log,ä»¥åŠåŸ‹ç‚¹ä¿¡æ¯è¿›è¡Œæ”¶é›†,å¹¶ç»è¿‡å¤šæ¬¡çš„ETL,å°†æ•°æ®åˆ†å±‚å†—ä½™å­˜å‚¨,ä¸»æµåˆ†å±‚ä¸»è¦æœ‰å››å±‚,ODSâ†’DWâ†’DWDâ†’DWTâ†’DMå±‚,å››å±‚æ•°æ®æ˜¯é€’è¿›çš„å…³ç³»,æ¯ä¸‹ä¸€å±‚æ•°æ®ç”±ä¸Šä¸€å±‚è½¬æ¢å¾—åˆ°,æ•°æ®ä»“åº“ä»…ä»…æ˜¯æ•°æ®é›†åˆ,è¦çœŸæ­£å®ç°å…¶ä½œç”¨,è¦çœ‹åœ¨å…¶ä¹‹ä¸Šå¼€å‘çš„ä¸šåŠ¡ç³»ç»Ÿ,æ¯”å¦‚æ•°æ®æŠ¥è¡¨ç³»ç»Ÿ,ç”¨æˆ·ç”»åƒç³»ç»Ÿ,æ¨èç³»ç»Ÿ,äººå·¥æ™ºèƒ½ç­‰è¿™äº›æ–¹é¢çš„åº”ç”¨.<br/><br />
ä¸€èˆ¬åŸºäºæ•°æ®ä»“åº“è¿›è¡Œç›¸å…³çš„æ•°æ®åˆ†æå¤§éƒ¨åˆ†å±äºOLAP(è”æœºäº‹åŠ¡åˆ†æ)<br/><br />
åŸºäºæ˜Ÿå½¢æ¨¡å‹ä¸é›ªèŠ±æ¨¡å‹çš„OLAPä¸€èˆ¬æ¶‰åŠä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µ:</p>
<ul>
<li>åº¦é‡:æ•°æ®åº¦é‡çš„æŒ‡æ ‡,æ•°æ®çš„ä¸–çºªå«ä¹‰</li>
<li>ç»´åº¦:æè¿°ä¸ä¸šåŠ¡ä¸»é¢˜ç›¸å…³çš„ä¸€ç»„å±æ€§</li>
<li>äº‹å®:ä¸åŒç»´åº¦åœ¨æŸä¸€å–å€¼ä¸‹çš„åº¦é‡</li>
</ul>
<p>OLAPçš„ç‰¹ç‚¹</p>
<ul>
<li>å¿«é€Ÿæ€§:ç”¨æˆ·å¯¹OLAPçš„å¿«é€Ÿååº”èƒ½åŠ›æœ‰å¾ˆé«˜çš„è¦æ±‚.ç³»ç»Ÿåº”èƒ½åœ¨5ç§’å†…å¯¹ç”¨æˆ·çš„å¤§éƒ¨åˆ†åˆ†æè¦æ±‚ä½œå‡ºåæ˜ </li>
<li>å¯åˆ†ææ€§:OLAPç³»ç»Ÿåº”èƒ½å¤„ç†å¯ä¸åº”ç”¨æœ‰å…³çš„ä»»ä½•é€»è¾‘åˆ†æå’Œç»Ÿè®¡åˆ†æ.</li>
<li>å¤šç»´æ€§: å¤šç»´æ€§æ˜¯OLAPçš„å…³é”®å±æ€§.ç³»ç»Ÿå¿…é¡»æä¾›å¯¹æ•°æ®çš„å¤šç»´è§†å›¾å’Œåˆ†æ,åŒ…æ‹¬å¯¹å±‚æ¬¡ç»´å’Œå¤šé‡å±‚æ¬¡ç»´çš„å®Œå…¨æ”¯æŒ</li>
<li>ä¿¡æ¯æ€§:ä¸è®ºæ•°æ®é‡æœ‰å¤šå¤§,ä¹Ÿä¸ç®¡æ•°æ®å­˜å‚¨åœ¨ä½•å¤„,OLAPç³»ç»Ÿåº”èƒ½å³ä½¿è·å¾—ä¿¡æ¯,å¹¶ä¸”ç®¡ç†å¤§å®¹é‡ä¿¡æ¯.</li>
</ul>
<p>åˆ†ç±»:<br />
æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»:</p>
<ul>
<li>ROLAP:å…³ç³»å‹åœ¨çº¿åˆ†æå¤„ç†</li>
<li>MOLAP:å¤šç»´åœ¨çº¿åˆ†æå¤„ç†</li>
<li>HOLAP:æ··åˆå‹åœ¨çº¿åˆ†æå¤„ç†</li>
</ul>
<p>æŒ‰ç…§å¤„ç†æ–¹å¼åˆ†ç±»:</p>
<ul>
<li>Server OLAPå’ŒClient OLAP</li>
</ul>
<p>æ“ä½œ:<br/><br />
ä¸‹é’»,ä¸Šå·,åˆ‡ç‰‡,åˆ‡å—,æ—‹è½¬<br />
æ•°æ®åº“ä¸æ•°æ®ä»“åº“çš„åŒºåˆ«:</p>
<ol>
<li>æ•°æ®åº“æ˜¯å¯¹ä¸šåŠ¡ç³»ç»Ÿçš„æ”¯æ‰¿,æ€§èƒ½è¦æ±‚é«˜,ç›¸åº”çš„æ—¶é—´çŸ­,è€Œæ•°æ®ä»“åº“å¯¹å“åº”æ—¶é—´æ²¡æœ‰å¤ªå¤šçš„è¦æ±‚,å½“ç„¶ä¹Ÿæ˜¯è¶Šå¿«è¶Šå¥½</li>
<li>æ•°æ®åº“å­˜å‚¨çš„æ˜¯æŸä¸€äº§å“çº¿æˆ–è€…åä¸šåŠ¡çº¿çš„æ•°æ®,æ•°æ®ä»“åº“å¯ä»¥å°†å¤šä¸ªæ•°æ®æºç»è¿‡ç»Ÿä¸€çš„è§„åˆ™æ¸…æ´—ä¹‹åè¿›è¡Œé›†ä¸­ç»Ÿä¸€ç®¡ç†</li>
<li>æ•°æ®åº“ä¸­å­˜å‚¨çš„æ•°æ®å¯ä»¥ä¿®æ”¹,æ— æ³•ä¿å­˜å„ä¸ªå†å²æ—¶åˆ»çš„æ•°æ®,æ•°æ®ä»“åº“å¯ä»¥ä¿å­˜å„ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®,å½¢æˆæ—¶é—´æ‹‰é“¾è¡¨,å¯ä»¥å¯¹å„ä¸ªå†å²æ—¶åˆ»çš„æ•°æ®åšåˆ†æ</li>
<li>æ•°æ®åº“ä¸€æ¬¡æ“ä½œçš„æ•°æ®é‡å°,æ•°æ®ä»“åº“æ“ä½œçš„æ•°æ®é‡å¤§</li>
<li>æ•°æ®åº“ä½¿ç”¨çš„æ˜¯å®ä½“-å…³ç³»(E-R)æ¨¡å‹,æ•°æ®ä»“åº“ä½¿ç”¨çš„æ˜¯æ˜Ÿæ˜Ÿæ¨¡å‹æˆ–é›ªèŠ±æ¨¡å‹</li>
<li>æ•°æ®åº“æ˜¯é¢å‘äº‹åŠ¡çº§åˆ«çš„æ“ä½œ,æ•°æ®ä»“åº“æ˜¯é¢å‘åˆ†æçš„æ“ä½œ.</li>
</ol>
<h3 id="hiveçš„æ¶æ„"><a class="markdownIt-Anchor" href="#hiveçš„æ¶æ„"></a> hiveçš„æ¶æ„</h3>
<p>æ¶æ„æˆ‘ä»¬ä¸€èˆ¬å°†hiveä¸­çš„è§’è‰²åˆ†ç±»,hiveä¸»è¦å››è§’è‰²:<br/><br />
<strong>1. ç”¨æˆ·è®¿é—®æ¥å£(clientç«¯)</strong></p>
<ul>
<li>CLI:ç”¨æˆ·å¯ä»¥ä½¿ç”¨hiveè‡ªå¸¦çš„å‘½ä»¤è¡Œæ¥å£æ‰§è¡ŒHiveSQ è®¾ç½®å‚æ•°ç­‰</li>
<li>JDBC/ODBC:ç”¨æˆ·ä½¿ç”¨JDBCæˆ–è€…ODBCçš„æ–¹å¼åœ¨ä»£ç ä¸­æ“ä½œHive</li>
<li>æµè§ˆå™¨æ¥å£,ç”¨æˆ·å¯ä»¥åœ¨æµè§ˆå™¨ä¸­å¯¹Hiveè¿›è¡Œæ“ä½œ(2.2ä¹‹åæ·˜æ±°)</li>
</ul>
<p><strong>2. Thrift Server</strong></p>
<ul>
<li>ThriftæœåŠ¡,è¿è¡Œå®¢æˆ·ç«¯ä½¿ç”¨Java,C++,Rubyç­‰å¤šç§è¯­è¨€,é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼è¿œç¨‹è®¿é—®Hive</li>
</ul>
<p><strong>3. Driver</strong></p>
<ul>
<li>Hive Driveræ˜¯Hiveçš„æ ¸å¿ƒ,å…¶ä¸­åŒ…å«è§£é‡Šå™¨,ç¼–è¯‘å™¨,ä¼˜åŒ–å™¨ç­‰å„ä¸ªç»„ä»¶,å®Œæˆä»SQLè¯­å¥åˆ°MapReduceä»»åŠ¡çš„è§£æä¼˜åŒ–æ‰§è¡Œè¿‡ç¨‹</li>
</ul>
<p><strong>4.metastore</strong></p>
<ul>
<li>Hiveçš„å…ƒæ•°æ®å­˜å‚¨æœåŠ¡,ä¸€èˆ¬å°†æ•°æ®å­˜å‚¨åˆ°å…³ç³»å‹æ•°æ®åº“,ä¸ºäº†å®ç°Hiveå…ƒæ•°æ®çš„æŒä¹…åŒ–æ“ä½œ,Hiveçš„å®‰è£…åŒ…ä¸­è‡ªå¸¦äº†Derbyå†…å­˜æ•°æ®åº“,ä½†æ˜¯å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬ä½¿ç”¨mysqlæ¥å­˜å‚¨å…ƒæ•°æ®.</li>
</ul>
<h3 id="hiveè¿œç¨‹æ•°æ®åº“metastoreä»¥åŠhiveserer2çš„é…ç½®æ–¹æ³•"><a class="markdownIt-Anchor" href="#hiveè¿œç¨‹æ•°æ®åº“metastoreä»¥åŠhiveserer2çš„é…ç½®æ–¹æ³•"></a> hiveè¿œç¨‹æ•°æ®åº“,metastoreä»¥åŠhiveserer2çš„é…ç½®æ–¹æ³•</h3>
<p>PS:hiveæœ¬åœ°æ¨¡å¼é…ç½®ç•¥è¿‡,ä¼ä¸šä¸­åŸºæœ¬ä¸ä¼šä½¿ç”¨åˆ°</p>
<h4 id="hiveè¿œç¨‹æ•°æ®åº“æ¨¡å¼"><a class="markdownIt-Anchor" href="#hiveè¿œç¨‹æ•°æ®åº“æ¨¡å¼"></a> hiveè¿œç¨‹æ•°æ®åº“æ¨¡å¼</h4>
<p>(å‰æmysqlæœåŠ¡å·²å¯åŠ¨)</p>
<ol>
<li>è§£å‹å®‰è£…</li>
<li>ä¿®æ”¹ç¯å¢ƒå˜é‡</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line">export HIVE_HOME=/opt/bigdata/hive-2.3.4</span><br><span class="line">å°†binç›®å½•æ·»åŠ åˆ°PATHè·¯å¾„ä¸­</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//ä¿®æ”¹æ–‡ä»¶åç§°ï¼Œå¿…é¡»ä¿®æ”¹ï¼Œæ–‡ä»¶åç§°å¿…é¡»æ˜¯hive-site.xml</span><br><span class="line">		mv hive-default.xml.template hive-site.xml</span><br><span class="line">	//å¢åŠ é…ç½®ï¼š</span><br><span class="line">			è¿›å…¥åˆ°æ–‡ä»¶ä¹‹åï¼Œå°†æ–‡ä»¶åŸæœ‰çš„é…ç½®åˆ é™¤ï¼Œä½†æ˜¯ä¿ç•™æœ€åä¸€è¡Œï¼Œ</span><br><span class="line">			ä»&lt;configuration&gt;&lt;/configuration&gt;ï¼Œå°†å…‰æ ‡ç§»åŠ¨åˆ°&lt;configuration&gt;è¿™ä¸€è¡Œï¼Œ</span><br><span class="line">			åœ¨viçš„æœ«è¡Œæ¨¡å¼ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤</span><br><span class="line">			:.,$-1d</span><br><span class="line">	//å¢åŠ å¦‚ä¸‹é…ç½®ä¿¡æ¯ï¼š</span><br><span class="line">			&lt;property&gt;</span><br><span class="line">				&lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span><br><span class="line">				&lt;value&gt;/user/hive/warehouse&lt;/value&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">			&lt;property&gt;</span><br><span class="line">				&lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">				&lt;value&gt;jdbc:mysql://node01:3306/hive?createDatabaseIfNotExist=true&lt;/value&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">			&lt;property&gt;</span><br><span class="line">				&lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">				&lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">			&lt;property&gt;</span><br><span class="line">				&lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">				&lt;value&gt;root&lt;/value&gt;</span><br><span class="line">			&lt;/property&gt;</span><br><span class="line">			&lt;property&gt;</span><br><span class="line">				&lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">				&lt;value&gt;123&lt;/value&gt;</span><br><span class="line">			&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>æ‹·è´JDBCé©±åŠ¨åŒ…</li>
<li>æ‰§è¡Œå…ƒæ•°æ®åˆå§‹åŒ–</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schematool -dbType mysql -initSchema</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>æ‰§è¡Œhiveå‘½ä»¤å¯åŠ¨æœåŠ¡</li>
</ol>
<h4 id="hive-metastoreæœåŠ¡æ¨¡å¼"><a class="markdownIt-Anchor" href="#hive-metastoreæœåŠ¡æ¨¡å¼"></a> hive metastoreæœåŠ¡æ¨¡å¼</h4>
<p>å‡è®¾å››å°æœåŠ¡å™¨,node03ä½œä¸ºæœåŠ¡ç«¯å’Œnode04ä½œä¸ºå®¢æˆ·ç«¯</p>
<ol>
<li>å‘node03ä»¥åŠnode04åˆ†å‘hiveåŒ…</li>
<li>ä¿®æ”¹node03 hive-site.xmlé…ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;/user/hive_remote/warehouse&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;jdbc:mysql://node01:3306/hive_remote?createDatabaseIfNotExist=true&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;root&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;123&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>node04 hive-site.xmlé…ç½®</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.metastore.warehouse.dir&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;/user/hive_remote/warehouse&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;hive.metastore.uris&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;thrift://node03:9083&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>åœ¨node03æœåŠ¡ç«¯æ‰§è¡Œå…ƒæ•°æ®åˆå§‹åŒ–æ“ä½œ,schematool -dbType mysql -initSchema</li>
<li>åœ¨node03ä¸Šæ‰§è¡Œhive --service metastore,å¯åŠ¨hiveçš„å…ƒæ•°æ®æœåŠ¡,æ˜¯é˜»å¡å¼çª—å£</li>
<li>åœ¨node04ä¸Šæ‰§è¡Œmysql,è¿›å…¥åˆ°hiveçš„cliçª—å£</li>
</ol>
<h4 id="hiveserver2-é…ç½®"><a class="markdownIt-Anchor" href="#hiveserver2-é…ç½®"></a> hiveServer2 é…ç½®</h4>
<p>(åœ¨é…ç½®metastoreæœåŠ¡çš„åŸºç¡€ä¸Š)</p>
<ol>
<li>åœ¨hdfsçš„core-site.xmlä¸­è®¾ç½®è¶…çº§ç”¨æˆ·çš„ç®¡ç†æƒé™,ä¿®æ”¹é…ç½®å¦‚ä¸‹:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åœ¨hdfsé›†ç¾¤çš„core-site.xmlæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®æ–‡ä»¶</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;*&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">		&lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;*&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">é…ç½®å®Œæˆä¹‹åé‡æ–°å¯åŠ¨é›†ç¾¤ï¼Œæˆ–è€…åœ¨namenodeçš„èŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</span><br><span class="line">hdfs dfsadmin -fs hdfs://node01:8020 -refreshSuperUserGroupsConfiguration</span><br><span class="line">hdfs dfsadmin -fs hdfs://node02:8020 -refreshSuperUserGroupsConfiguration</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„,è¿™å…¶ä¸­çš„rootéœ€è¦æ”¹æˆ,æ‰§è¡Œhiveserver2çš„linuxç³»ç»Ÿç”¨æˆ·å<br />
åœ¨node03ä¸Šæ‰§è¡Œhive --service metastoreå…ƒæ•°æ®æœåŠ¡<br />
åœ¨node04ä¸Šè¿è¡Œhiveserer2æˆ–è€…hive --service hiveserver2 <br/><br />
<strong>hiveserver2é€šè¿‡beelineè¿›è¡Œç›¸åº”çš„è®¿é—®</strong><br/><br />
beelineé€šè¿‡ä¸¤ç§æ–¹å¼è®¿é—®:</p>
<ol>
<li>é€šè¿‡å‘½ä»¤è¡Œè®¿é—® beeline -u jdbc:hive2://ğŸ˜• -n name</li>
<li>é€šè¿‡beelineè¿›å…¥clientæ¨¡å¼åè¾“å…¥beeline&gt;!connect jdbc:hive2://ğŸ˜• root 123<br />
<strong>jdbcè®¿é—®æ–¹å¼</strong><br/><br />
å°†hiveçš„libç›®å½•é‡Œé¢çš„jaråŒ…copyåˆ°å¼€å‘ç¯å¢ƒçš„classpathæ–‡ä»¶å¤¹,æœ€ç²¾ç®€çš„åŒ…å¦‚ä¸‹:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">commons-lang-2.6.jar</span><br><span class="line">commons-logging-1.2.jar</span><br><span class="line">curator-client-2.7.1.jar</span><br><span class="line">curator-framework-2.7.1.jar</span><br><span class="line">guava-14.0.1.jar</span><br><span class="line">hive-exec-2.3.4.jar</span><br><span class="line">hive-jdbc-2.3.4.jar</span><br><span class="line">hive-jdbc-handler-2.3.4.jar</span><br><span class="line">hive-metastore-2.3.4.jar</span><br><span class="line">hive-service-2.3.4.jar</span><br><span class="line">hive-service-rpc-2.3.4.jar</span><br><span class="line">httpclient-4.4.jar</span><br><span class="line">httpcore-4.4.jar</span><br><span class="line">libfb303-0.9.3.jar</span><br><span class="line">libthrift-0.9.3.jar</span><br><span class="line">log4j-1.2-api-2.6.2.jar</span><br><span class="line">log4j-api-2.6.2.jar</span><br><span class="line">log4j-core-2.6.2.jar</span><br><span class="line">log4j-jul-2.5.jar</span><br><span class="line">log4j-slf4j-impl-2.6.2.jar</span><br><span class="line">log4j-web-2.6.2.jar</span><br><span class="line">zookeeper-3.4.6.jar</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªHiveJDBCè¿æ¥çš„demo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package com.mashibing;</span><br><span class="line"></span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.Statement;</span><br><span class="line"></span><br><span class="line">public class HiveJdbcClient &#123;</span><br><span class="line"></span><br><span class="line">	private static String driverName = &quot;org.apache.hive.jdbc.HiveDriver&quot;;</span><br><span class="line"></span><br><span class="line">	public static void main(String[] args) throws SQLException &#123;</span><br><span class="line">		try &#123;</span><br><span class="line">			Class.forName(driverName);</span><br><span class="line">		&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		Connection conn = DriverManager.getConnection(&quot;jdbc:hive2://node04:10000/default&quot;, &quot;root&quot;, &quot;&quot;);</span><br><span class="line">		Statement stmt = conn.createStatement();</span><br><span class="line">		String sql = &quot;select * from psn limit 5&quot;;</span><br><span class="line">		ResultSet res = stmt.executeQuery(sql);</span><br><span class="line">		while (res.next()) &#123;</span><br><span class="line">			System.out.println(res.getString(1) + &quot;-&quot; + res.getString(&quot;name&quot;));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="hiveçš„sqlå‡½æ•°å‚æ•°"><a class="markdownIt-Anchor" href="#hiveçš„sqlå‡½æ•°å‚æ•°"></a> hiveçš„SQL,å‡½æ•°,å‚æ•°</h3>
<h4 id="sqlè¯­å¥ä¹‹ddlè¯­å¥"><a class="markdownIt-Anchor" href="#sqlè¯­å¥ä¹‹ddlè¯­å¥"></a> SQLè¯­å¥ä¹‹DDLè¯­å¥</h4>
<p>hiveçš„SQLå’Œå…¶ä»–çš„SQLè¯­å¥å¾ˆç›¸ä¼¼å…·ä½“çš„æ•°æ®åº“è¡¨æ“ä½œè¯­å¥è¯­å¥å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">create database æ•°æ®åº“å;  \\åˆ›å»ºæ•°æ®åº“</span><br><span class="line">drop database æ•°æ®åº“å; \\åˆ é™¤æ•°æ®åº“</span><br><span class="line">drop table è¡¨å; \\åˆ é™¤è¡¨</span><br><span class="line">show databses; \\æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨</span><br><span class="line">show tables; \\æ˜¾ç¤ºè¡¨åˆ—è¡¨</span><br><span class="line">use æ•°æ®åº“å; \\åˆ‡æ¢æ•°æ®åº“</span><br><span class="line">desc è¡¨å; \\æ˜¾ç¤ºè¡¨å</span><br><span class="line">desc format è¡¨å; \\æ˜¾ç¤ºè¡¨æ˜å¹¶åˆ—å‡ºè¯¦ç»†çš„formatä¿¡æ¯</span><br><span class="line">åˆ›å»ºè¡¨å,å¯é€‰é¡¹æ¯”è¾ƒå¤šè¿™é‡Œç»™å‡ºå®˜æ–¹è¯­æ³•:</span><br><span class="line">		CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name    -- 			(Note: TEMPORARY available in Hive 0.14.0 and later)</span><br><span class="line">  		[(col_name data_type [COMMENT col_comment], ... [constraint_specification])]</span><br><span class="line">  		[COMMENT table_comment]</span><br><span class="line">  		[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)]</span><br><span class="line">  		[CLUSTERED BY (col_name, col_name, ...) [SORTED BY (col_name [ASC|DESC], ...)] 				INTO num_buckets BUCKETS]</span><br><span class="line">  		[SKEWED BY (col_name, col_name, ...)                  -- (Note: Available in Hive 			0.10.0 and later)]</span><br><span class="line">     	ON ((col_value, col_value, ...), (col_value, col_value, ...), ...)</span><br><span class="line">     	[STORED AS DIRECTORIES]</span><br><span class="line">  		[</span><br><span class="line">   			[ROW FORMAT row_format]</span><br><span class="line">   			[STORED AS file_format]</span><br><span class="line">     		| STORED BY &#x27;storage.handler.class.name&#x27; [WITH SERDEPROPERTIES (...)]  -- 				(Note: Available in Hive 0.6.0 and later)</span><br><span class="line">  		]</span><br><span class="line">  		[LOCATION hdfs_path]</span><br><span class="line">  		[TBLPROPERTIES (property_name=property_value, ...)]   -- (Note: Available in Hive 			0.6.0 and later)</span><br><span class="line">  		[AS select_statement];   -- (Note: Available in Hive 0.5.0 and later; not 					supported for external tables)</span><br><span class="line"></span><br><span class="line">		CREATE [TEMPORARY] [EXTERNAL] TABLE [IF NOT EXISTS] [db_name.]table_name</span><br><span class="line">  			LIKE existing_table_or_view_name</span><br><span class="line">  		[LOCATION hdfs_path];</span><br><span class="line"> 		å¤æ‚æ•°æ®ç±»å‹</span><br><span class="line">		data_type</span><br><span class="line">  		 : primitive_type</span><br><span class="line">  		 | array_type</span><br><span class="line">  		 | map_type</span><br><span class="line">  		 | struct_type</span><br><span class="line">  		 | union_type  -- (Note: Available in Hive 0.7.0 and later)</span><br><span class="line"> 		åŸºæœ¬æ•°æ®ç±»å‹</span><br><span class="line">		primitive_type</span><br><span class="line"> 		 : TINYINT</span><br><span class="line"> 		 | SMALLINT</span><br><span class="line"> 		 | INT</span><br><span class="line"> 		 | BIGINT</span><br><span class="line"> 		 | BOOLEAN</span><br><span class="line"> 		 | FLOAT</span><br><span class="line"> 		 | DOUBLE</span><br><span class="line">  		 | DOUBLE PRECISION -- (Note: Available in Hive 2.2.0 and later)</span><br><span class="line"> 		 | STRING</span><br><span class="line"> 		 | BINARY      -- (Note: Available in Hive 0.8.0 and later)</span><br><span class="line"> 		 | TIMESTAMP   -- (Note: Available in Hive 0.8.0 and later)</span><br><span class="line"> 		 | DECIMAL     -- (Note: Available in Hive 0.11.0 and later)</span><br><span class="line"> 		 | DECIMAL(precision, scale)  -- (Note: Available in Hive 0.13.0 and later)</span><br><span class="line"> 		 | DATE        -- (Note: Available in Hive 0.12.0 and later)</span><br><span class="line"> 		 | VARCHAR     -- (Note: Available in Hive 0.12.0 and later)</span><br><span class="line"> 		 | CHAR        -- (Note: Available in Hive 0.13.0 and later)</span><br><span class="line"></span><br><span class="line">		array_type</span><br><span class="line"> 		 : ARRAY &lt; data_type &gt;</span><br><span class="line"></span><br><span class="line">		map_type</span><br><span class="line"> 		 : MAP &lt; primitive_type, data_type &gt;</span><br><span class="line"></span><br><span class="line">		struct_type</span><br><span class="line"> 		 : STRUCT &lt; col_name : data_type [COMMENT col_comment], ...&gt;</span><br><span class="line"></span><br><span class="line">		union_type</span><br><span class="line">  		 : UNIONTYPE &lt; data_type, data_type, ... &gt;  -- (Note: Available in Hive 0.7.0 and 			later)</span><br><span class="line"> 		è¡Œæ ¼å¼è§„èŒƒ</span><br><span class="line">		row_format</span><br><span class="line"> 		 : DELIMITED [FIELDS TERMINATED BY char [ESCAPED BY char]] [COLLECTION ITEMS 				TERMINATED BY char]</span><br><span class="line"> 	       [MAP KEYS TERMINATED BY char] [LINES TERMINATED BY char]</span><br><span class="line">	       [NULL DEFINED AS char]   -- (Note: Available in Hive 0.13 and later)</span><br><span class="line">  			| SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, 				property_name=property_value, ...)]</span><br><span class="line"> 		æ–‡ä»¶åŸºæœ¬ç±»å‹</span><br><span class="line">		file_format:</span><br><span class="line"> 		 : SEQUENCEFILE</span><br><span class="line"> 		 | TEXTFILE    -- (Default, depending on hive.default.fileformat configuration)</span><br><span class="line"> 		 | RCFILE      -- (Note: Available in Hive 0.6.0 and later)</span><br><span class="line"> 		 | ORC         -- (Note: Available in Hive 0.11.0 and later)</span><br><span class="line"> 		 | PARQUET     -- (Note: Available in Hive 0.13.0 and later)</span><br><span class="line"> 		 | AVRO        -- (Note: Available in Hive 0.14.0 and later)</span><br><span class="line"> 		 | JSONFILE    -- (Note: Available in Hive 4.0.0 and later)</span><br><span class="line"> 		 | INPUTFORMAT input_format_classname OUTPUTFORMAT output_format_classname</span><br><span class="line"> 		è¡¨çº¦æŸ</span><br><span class="line">		constraint_specification:</span><br><span class="line"> 		 : [, PRIMARY KEY (col_name, ...) DISABLE NOVALIDATE ]</span><br><span class="line"> 		   [, CONSTRAINT constraint_name FOREIGN KEY (col_name, ...) REFERENCES 					table_name(col_name, ...) DISABLE NOVALIDATE</span><br><span class="line">*/</span><br><span class="line">hivefåˆ†è¡¨è¯­æ³•:</span><br><span class="line">alter table è¡¨å add partition(col_name=col_value)</span><br><span class="line">alter table è¡¨å drop partition(col_name=col_vaule)</span><br><span class="line">æ³¨æ„å¦‚æœæ˜¯å¤šåˆ†è¡¨,æ·»åŠ è¡¨è¦æ·»åŠ æ‰€æœ‰åµŒå¥—çš„åˆ†åŒºå€¼</span><br></pre></td></tr></table></figure>
<h4 id="hive-sqlè¯­å¥ä¹‹dmlè¯­å¥"><a class="markdownIt-Anchor" href="#hive-sqlè¯­å¥ä¹‹dmlè¯­å¥"></a> hive SQLè¯­å¥ä¹‹DMLè¯­å¥</h4>
<p>æ’å…¥æ•°æ®æœ‰ä¸‰ç§ç§æ–¹å¼:<br/><br />
load fileæ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--åŠ è½½æœ¬åœ°æ•°æ®åˆ°hiveè¡¨</span><br><span class="line">	load data local inpath &#x27;/root/data/data&#x27; into table psn;--(/root/data/dataæŒ‡çš„æ˜¯æœ¬åœ°		linuxç›®å½•)</span><br><span class="line">--åŠ è½½hdfsæ•°æ®æ–‡ä»¶åˆ°hiveè¡¨</span><br><span class="line">	load data inpath &#x27;/data/data&#x27; into table psn;--(/data/dataæŒ‡çš„æ˜¯hdfsçš„ç›®å½•)</span><br></pre></td></tr></table></figure>
<p>insert dataæ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--ä»è¡¨ä¸­æŸ¥è¯¢æ•°æ®æ’å…¥ç»“æœè¡¨</span><br><span class="line">	INSERT OVERWRITE TABLE psn9 SELECT id,name FROM psn</span><br><span class="line">--ä»è¡¨ä¸­è·å–éƒ¨åˆ†åˆ—æ’å…¥åˆ°æ–°è¡¨ä¸­</span><br><span class="line">	from psn</span><br><span class="line">	insert overwrite table psn9</span><br><span class="line">	select id,name</span><br><span class="line">	insert into table psn10</span><br><span class="line">	select id</span><br></pre></td></tr></table></figure>
<p>insert sqlæ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--æ’å…¥æ•°æ®</span><br><span class="line">	insert into psn values(1,&#x27;zhangsan&#x27;)</span><br></pre></td></tr></table></figure>
<p>æ•°æ®æ›´æ–°å’Œåˆ é™¤å¹³å¸¸å¾ˆå°‘ç”¨åˆ°,å¦‚æœä½¿ç”¨è¯·å‚è€ƒä¸‹é¢é…ç½®å¼€å¯äº‹åŠ¡:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//åœ¨hiveçš„hive-site.xmlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.support.concurrency&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;true&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.enforce.bucketing&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;true&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.exec.dynamic.partition.mode&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;nonstrict&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.txn.manager&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;org.apache.hadoop.hive.ql.lockmgr.DbTxnManager&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.compactor.initiator.on&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;true&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">	&lt;property&gt;</span><br><span class="line">		&lt;name&gt;hive.compactor.worker.threads&lt;/name&gt;</span><br><span class="line">		&lt;value&gt;1&lt;/value&gt;</span><br><span class="line">	&lt;/property&gt;</span><br><span class="line">//æ“ä½œè¯­å¥</span><br><span class="line">	create table test_trancaction (user_id Int,name String) clustered by (user_id) into 3 			buckets stored as orc TBLPROPERTIES (&#x27;transactional&#x27;=&#x27;true&#x27;);</span><br><span class="line">	create table test_insert_test(id int,name string) row format delimited fields 				  TERMINATED BY &#x27;,&#x27;;</span><br><span class="line">	insert into test_trancaction select * from test_insert_test;</span><br><span class="line">	update test_trancaction set name=&#x27;jerrick_up&#x27; where id=1;</span><br><span class="line">//æ•°æ®æ–‡ä»¶</span><br><span class="line">	1,jerrick</span><br><span class="line">	2,tom</span><br><span class="line">	3,jerry</span><br><span class="line">	4,lily</span><br><span class="line">	5,hanmei</span><br><span class="line">	6,limlei</span><br><span class="line">	7,lucky</span><br></pre></td></tr></table></figure>
<h4 id="hive-serde"><a class="markdownIt-Anchor" href="#hive-serde"></a> hive serde</h4>
<p>å¦‚æœæˆ‘ä»¬æ•°æ®æ–‡ä»¶æ˜¯logå½¢å¼åƒä¸‹é¢è¿™æ ·<br />
192.168.57.4 - - [29/Feb/2019:18:14:35 +0800](1.1&quot; 304 -<br />
è¿™ç§åµŒå¥—æ¯”è¾ƒè´Ÿè½½çš„æ–¹å¼å»ºè®®ä½¿ç”¨hive serde<br />
è¯­æ³•å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">row_format</span><br><span class="line">		: DELIMITED</span><br><span class="line">          [FIELDS TERMINATED BY char [ESCAPED BY char]]</span><br><span class="line">          [COLLECTION ITEMS TERMINATED BY char]</span><br><span class="line">          [MAP KEYS TERMINATED BY char]</span><br><span class="line">          [LINES TERMINATED BY char]</span><br><span class="line">		: SERDE serde_name [WITH SERDEPROPERTIES (property_name=property_value, 										            property_name=property_value, ...)]</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">192.168.57.4 - - [29/Feb/2019:18:14:35 +0800](1.1&quot; 304 -</span><br><span class="line">--åˆ›å»ºè¡¨</span><br><span class="line">	CREATE TABLE logtbl (</span><br><span class="line">	    host STRING,</span><br><span class="line">	    identity STRING,</span><br><span class="line">	    t_user STRING,</span><br><span class="line">	    time STRING,</span><br><span class="line">	    request STRING,</span><br><span class="line">	    referer STRING,</span><br><span class="line">	    agent STRING)</span><br><span class="line">	  ROW FORMAT SERDE &#x27;org.apache.hadoop.hive.serde2.RegexSerDe&#x27;</span><br><span class="line">	  WITH SERDEPROPERTIES (</span><br><span class="line">	    &quot;input.regex&quot; = &quot;([^ ]*) ([^ ]*) ([^ ]*) \\[(.*)\\] \&quot;(.*)\&quot; (-|[0-9]*) (-|[0-		9]*)&quot;</span><br><span class="line">	  )</span><br><span class="line">  STORED AS TEXTFILE;</span><br><span class="line">--åŠ è½½æ•°æ®</span><br><span class="line">	load data local inpath &#x27;/root/data/log&#x27; into table logtbl;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="hive-åŠ¨æ€åˆ†åŒºä¸åˆ†æ¡¶"><a class="markdownIt-Anchor" href="#hive-åŠ¨æ€åˆ†åŒºä¸åˆ†æ¡¶"></a> hive åŠ¨æ€åˆ†åŒºä¸åˆ†æ¡¶</h4>
<p>è¦å¼€å¯åŠ¨æ€åˆ†åŒºéœ€è¦å…ˆè¿›è¡Œå¦‚ä¸‹è®¾ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--hiveè®¾ç½®hiveåŠ¨æ€åˆ†åŒºå¼€å¯</span><br><span class="line">	set hive.exec.dynamic.partition=true;</span><br><span class="line">	é»˜è®¤ï¼štrue</span><br><span class="line">--hiveçš„åŠ¨æ€åˆ†åŒºæ¨¡å¼</span><br><span class="line">	set hive.exec.dynamic.partition.mode=nostrict;</span><br><span class="line">	é»˜è®¤ï¼šstrictï¼ˆè‡³å°‘æœ‰ä¸€ä¸ªåˆ†åŒºåˆ—æ˜¯é™æ€åˆ†åŒºï¼‰</span><br><span class="line">--æ¯ä¸€ä¸ªæ‰§è¡ŒmrèŠ‚ç‚¹ä¸Šï¼Œå…è®¸åˆ›å»ºçš„åŠ¨æ€åˆ†åŒºçš„æœ€å¤§æ•°é‡(100)</span><br><span class="line">	set hive.exec.max.dynamic.partitions.pernode;</span><br><span class="line">--æ‰€æœ‰æ‰§è¡ŒmrèŠ‚ç‚¹ä¸Šï¼Œå…è®¸åˆ›å»ºçš„æ‰€æœ‰åŠ¨æ€åˆ†åŒºçš„æœ€å¤§æ•°é‡(1000)</span><br><span class="line">	set hive.exec.max.dynamic.partitions;</span><br><span class="line">--æ‰€æœ‰çš„mr jobå…è®¸åˆ›å»ºçš„æ–‡ä»¶çš„æœ€å¤§æ•°é‡(100000)</span><br><span class="line">	set hive.exec.max.created.files;</span><br></pre></td></tr></table></figure>
<p>hiveåŠ¨æ€åˆ†åŒºè¯­æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-Hive extension (dynamic partition inserts):</span><br><span class="line">	INSERT OVERWRITE TABLE tablename PARTITION (partcol1[=val1], partcol2[=val2] ...) 		select_statement FROM from_statement;</span><br><span class="line">	INSERT INTO TABLE tablename PARTITION (partcol1[=val1], partcol2[=val2] ...) 			select_statement FROM from_statement;</span><br></pre></td></tr></table></figure>
<p>hiveåˆ†æ¡¶</p>
<ul>
<li>hiveåˆ†æ¡¶æ˜¯å¯¹åˆ—å€¼å–hashå€¼çš„æ–¹å¼,å°†ä¸åŒçš„æ•°æ®æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­å­˜å‚¨</li>
<li>å¯¹äºhiveä¸­æ¯ä¸€ä¸ªè¡¨,åˆ†åŒºéƒ½å¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œåˆ†æ¡¶</li>
<li>ç”±åˆ—çš„hashå€¼é™¤ä»¥æ¡¶çš„ä¸ªæ•°æ®å†³å®šæ¯æ¡æ•°æ®åˆ’åˆ†åˆ°å“ªä¸ªæ¡¶ä¸­<br />
hiveåˆ†æ¡¶çš„é…ç½®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--è®¾ç½®hiveæ”¯æŒåˆ†æ¡¶</span><br><span class="line">	set hive.enforce.bucketing=true;</span><br></pre></td></tr></table></figure>
<p>hiveåˆ†æ¡¶çš„æŠ½æ ·æŸ¥è¯¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from bucket_table tablesample(bucket 1 out of 4 on columns)</span><br><span class="line">-TABLESAMPLEè¯­æ³•ï¼š</span><br><span class="line">	TABLESAMPLE(BUCKET x OUT OF y)</span><br><span class="line">		xï¼šè¡¨ç¤ºä»å“ªä¸ªbucketå¼€å§‹æŠ½å–æ•°æ®</span><br><span class="line">		yï¼šå¿…é¡»ä¸ºè¯¥è¡¨æ€»bucketæ•°çš„å€æ•°æˆ–å› å­</span><br></pre></td></tr></table></figure>
<h4 id="hiveçš„å‡½æ•°"><a class="markdownIt-Anchor" href="#hiveçš„å‡½æ•°"></a> hiveçš„å‡½æ•°</h4>
<p>hiveå‡½æ•°æœ‰å¤šç§è®¾ç½®æ–¹æ³•</p>
<ol>
<li>åœ¨hive-site.xml æ–‡ä»¶ä¸­è®¾ç½®</li>
<li>åœ¨æœ¬åœ°homeæ–‡ä»¶æ–°å»ºä¸€ä¸ª.hivercæ–‡ä»¶,å¯ä»¥åœ¨é‡Œé¢è®¾ç½®å‚æ•°</li>
<li>é€šè¿‡hive -hiveconf  key=vauleçš„æ–¹å¼å¯åŠ¨</li>
<li>åœ¨hiveå‘½ä»¤è¡Œä¸­ç”¨setæ–¹æ³•è®¾ç½®</li>
</ol>
<p>é€šè¿‡åœ¨hiveå½“ä¸­è®¾ç½®</p>
<h4 id="hiveçš„è¿è¡Œæ–¹å¼"><a class="markdownIt-Anchor" href="#hiveçš„è¿è¡Œæ–¹å¼"></a> hiveçš„è¿è¡Œæ–¹å¼</h4>
<p>1.å‘½ä»¤è¡Œæ–¹å¼æˆ–è€…æ§åˆ¶å°æ¨¡å¼<br />
2.è„šæœ¬è¿è¡Œæ–¹å¼<br />
3.JDBCæ–¹å¼<br />
<a target="_blank" rel="noopener" href="http://4.WEB">4.WEB</a> GUIæ–¹å¼<br />
<strong>å‘½ä»¤è¡Œæ¨¡å¼çš„ä¸€äº›tips</strong></p>
<ul>
<li>ç›´æ¥è¾“å…¥SQLè¯­å¥,select * from table_name</li>
<li>å‘½ä»¤è¡Œä¸hdfsäº¤äº’ dfs ls /</li>
<li>å‘½ä»¤è¡Œä¸linuxäº¤äº’ !pwd æˆ–è€…!ls /<br />
<strong>è„šæœ¬è¿è¡Œæ–¹å¼</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--hiveç›´æ¥æ‰§è¡Œsqlå‘½ä»¤ï¼Œå¯ä»¥å†™ä¸€ä¸ªsqlè¯­å¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨;åˆ†å‰²å†™å¤šä¸ªsqlè¯­å¥</span><br><span class="line">	hive -e &quot;&quot;</span><br><span class="line">--hiveæ‰§è¡Œsqlå‘½ä»¤ï¼Œå°†sqlè¯­å¥æ‰§è¡Œçš„ç»“æœé‡å®šå‘åˆ°æŸä¸€ä¸ªæ–‡ä»¶ä¸­</span><br><span class="line">	hive -e &quot;&quot;&gt;aaa</span><br><span class="line">--hiveé™é»˜è¾“å‡ºæ¨¡å¼ï¼Œè¾“å‡ºçš„ç»“æœä¸­ä¸åŒ…å«okï¼Œtime tokenç­‰å…³é”®å­—</span><br><span class="line">	hive -S -e &quot;&quot;&gt;aaa</span><br><span class="line">--hiveå¯ä»¥ç›´æ¥è¯»å–æ–‡ä»¶ä¸­çš„sqlå‘½ä»¤ï¼Œè¿›è¡Œæ‰§è¡Œ</span><br><span class="line">	hive -f file</span><br><span class="line">--hiveå¯ä»¥ä»æ–‡ä»¶ä¸­è¯»å–å‘½ä»¤ï¼Œå¹¶ä¸”æ‰§è¡Œåˆå§‹åŒ–æ“ä½œ</span><br><span class="line">	hive -i /home/my/hive-init.sql</span><br><span class="line">--åœ¨hiveçš„å‘½ä»¤è¡Œä¸­ä¹Ÿå¯ä»¥æ‰§è¡Œå¤–éƒ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤</span><br><span class="line">	hive&gt; source file (åœ¨hive cliä¸­è¿è¡Œ)</span><br></pre></td></tr></table></figure>
<h4 id="hiveè§†å›¾"><a class="markdownIt-Anchor" href="#hiveè§†å›¾"></a> hiveè§†å›¾</h4>
<p>hiveè§†å›¾ä»…ä»…æ˜¯æ•°æ®çš„ä¸€ç§é€»è¾‘è¡¨ç¤º,æœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ¡SQLè¯­å¥çš„ç»“æœé›†,(hive3.0å¼•å…¥çš„ç‰©åŒ–è§†å›¾é™¤å¤–)<br />
å½“æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªéå¸¸é•¿çš„SQLæ—¶å¯ä»¥å…ˆå®šä¹‰è§†å›¾è¿™æ ·ä¸€ä¸ª&quot;ä¸­é—´è¡¨&quot;<br />
hiveè§†å›¾è¯­æ³•:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--åˆ›å»ºè§†å›¾ï¼š</span><br><span class="line">	CREATE VIEW [IF NOT EXISTS] [db_name.]view_name</span><br><span class="line">	  [(column_name [COMMENT column_comment], ...) ]</span><br><span class="line">	  [COMMENT view_comment]</span><br><span class="line">	  [TBLPROPERTIES (property_name = property_value, ...)]</span><br><span class="line">	  AS SELECT ... ;</span><br><span class="line">--æŸ¥è¯¢è§†å›¾ï¼š</span><br><span class="line">	select colums from view;</span><br><span class="line">--åˆ é™¤è§†å›¾ï¼š</span><br><span class="line">	DROP VIEW [IF EXISTS] [db_name.]view_name;</span><br></pre></td></tr></table></figure>
<p><strong>hive ç´¢å¼•</strong><br />
ç´¢å¼•åœ¨hiveå½“ä¸­å¾ˆå°‘ç”¨åˆ°,å› ä¸ºhiveä¸­ç´¢å¼•é…ç½®æ¯”è¾ƒéº»çƒ¦,æ¯æ¬¡æ›´æ–°æ•°æ®æ—¶è¿˜éœ€è¦æ›´æ–°ä¸€ä¸‹ç´¢å¼•,ä½†æ˜¯å¦‚æœå…¬å¸æœ‰éœ€æ±‚æ—¶,è¯·å‚è€ƒå¦‚ä¸‹SQL:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">	create index t1_index on table psn2(name)</span><br><span class="line">	as &#x27;org.apache.hadoop.hive.ql.index.compact.CompactIndexHandler&#x27; with deferred 			rebuild in table t1_index_table;</span><br><span class="line">--asï¼šæŒ‡å®šç´¢å¼•å™¨ï¼›</span><br><span class="line">--in tableï¼šæŒ‡å®šç´¢å¼•è¡¨ï¼Œè‹¥ä¸æŒ‡å®šé»˜è®¤ç”Ÿæˆåœ¨default__psn2_t1_index__è¡¨ä¸­</span><br><span class="line">	create index t1_index on table psn2(name)</span><br><span class="line">	as &#x27;org.apache.hadoop.hive.ql.index.compact.CompactIndexHandler&#x27; with deferred 			rebuild;</span><br><span class="line">--æŸ¥è¯¢ç´¢å¼•</span><br><span class="line">	show index on psn2;</span><br><span class="line">--é‡å»ºç´¢å¼•ï¼ˆå»ºç«‹ç´¢å¼•ä¹‹åå¿…é¡»é‡å»ºç´¢å¼•æ‰èƒ½ç”Ÿæ•ˆï¼‰</span><br><span class="line">	ALTER INDEX t1_index ON psn2 REBUILD;</span><br><span class="line">--åˆ é™¤ç´¢å¼•</span><br><span class="line">	DROP INDEX IF EXISTS t1_index ON psn2;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag"># åˆ†å¸ƒå¼</a>
              <a href="/tags/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/" rel="tag"># æ•°æ®ä»“åº“</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/08/21/mapreduce%E7%AC%94%E8%AE%B0-%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/" rel="prev" title="mapreduceç¬”è®°-æºç å‰–æ">
                  <i class="fa fa-chevron-left"></i> mapreduceç¬”è®°-æºç å‰–æ
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/09/04/hive-%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%9302/" rel="next" title="hive-ç¬”è®°æ€»ç»“02">
                  hive-ç¬”è®°æ€»ç»“02 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lemcoden</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
